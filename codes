HTML_PAGE = """
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>NeoArm Webapplication</title>

<style>
body {
    background:#f7f8fb;
    font-family:Arial, sans-serif;
    margin:0;
    padding:0;
}
.header {
    padding:20px;
    font-size:24px;
    font-weight:700;
    background:white;
    box-shadow:0 2px 4px rgba(0,0,0,0.1);
    display:flex;
    justify-content:space-between;
}
.status-dot {
    width:10px;
    height:10px;
    border-radius:50%;
    background:#00e676;
    display:inline-block;
}
.card {
    background:white;
    margin:15px;
    padding:20px;
    border-radius:12px;
    box-shadow:0 2px 5px rgba(0,0,0,0.08);
}
.section-title {
    font-size:18px;
    margin-bottom:10px;
    font-weight:600;
}

/* Buttons */
.mode-btn, .control-btn {
    padding:10px 18px;
    margin:5px;
    border-radius:8px;
    border:1px solid #ccc;
    background:#fff;
    font-weight:600;
}
.mode-btn.active, .control-btn.active {
    background:#00c853;
    color:white;
    border:1px solid #00c853;
}
.control-btn {
    width:120px;
}

.disabled {
    opacity:0.5;
    pointer-events:none;
}

/* GAUGES */
.gauge-box {
    background:#1b1d22;
    padding:20px;
    border-radius:15px;
    color:white;
    width:100%;
    text-align:center;
    margin-top:10px;
}
.gauge-title {
    font-size:16px;
    margin-bottom:10px;
}
.gauge-value {
    font-size:28px;
    margin-top:10px;
    color:#1de9b6;
}
</style>

</head>
<body>

<div class="header">
    NeoArm Webapplication
    <span><span class="status-dot"></span> Online</span>
</div>

<div class="card">
    <div class="section-title">Mode selection</div>
    <button class="mode-btn active" id="mode_fsr" onclick="setMode('fsr')">FSR</button>
    <button class="mode-btn" id="mode_pb" onclick="setMode('push')">Push Button</button>
    <button class="mode-btn" id="mode_wireless" onclick="setMode('wireless')">Wireless</button>
</div>

<div class="card">
    <div class="section-title">Control panel</div>

    <button class="control-btn" id="thumb" onclick="toggleControl('thumb')">OFF</button>
    <button class="control-btn" id="im" onclick="toggleControl('im')">OFF</button><br>

    <button class="control-btn" id="rp" onclick="toggleControl('rp')">OFF</button>
    <button class="control-btn" id="all" onclick="toggleControl('all')">OFF</button>
</div>

<div class="card">
    <div class="section-title">NeoArm Feedback</div>

    <div class="gauge-box">
        <div class="gauge-title">Pressure</div>
        <div class="gauge-value" id="pressure_val">0%</div>
    </div>

    <div class="gauge-box">
        <div class="gauge-title">Temperature</div>
        <div class="gauge-value" id="temp_val">0°C</div>
    </div>

    <div class="gauge-box">
        <div class="gauge-title">Battery Status</div>
        <div class="gauge-value" id="batt_val">0%</div>
    </div>
</div>


<script>
// ---------------------
// MODE SELECTION
// ---------------------
let currentMode = "fsr";

function setMode(mode) {
    currentMode = mode;

    document.getElementById("mode_fsr").classList.remove("active");
    document.getElementById("mode_pb").classList.remove("active");
    document.getElementById("mode_wireless").classList.remove("active");

    document.getElementById("mode_" + mode).classList.add("active");

    // Enable wireless controls ONLY when wireless mode selected
    if (mode === "wireless") {
        document.getElementById("thumb").classList.remove("disabled");
        document.getElementById("im").classList.remove("disabled");
        document.getElementById("rp").classList.remove("disabled");
        document.getElementById("all").classList.remove("disabled");
    } else {
        // disable manual control when not wireless
        document.getElementById("thumb").classList.add("disabled");
        document.getElementById("im").classList.add("disabled");
        document.getElementById("rp").classList.add("disabled");
        document.getElementById("all").classList.add("disabled");
    }

    fetch("/set_mode?mode=" + mode);
}

// ---------------------
// CONTROL BUTTONS
// ---------------------
function toggleControl(id) {
    fetch("/control?id=" + id)
    .then(res => res.json())
    .then(data => {
        document.getElementById(id).innerHTML = data.state ? "ON" : "OFF";
        if (data.state) document.getElementById(id).classList.add("active");
        else document.getElementById(id).classList.remove("active");
    });
}

// ---------------------
// LIVE FEEDBACK AUTO-UPDATE
// ---------------------
function updateFeedback() {
    fetch("/feedback")
    .then(res => res.json())
    .then(data => {
        document.getElementById("pressure_val").innerHTML = data.palm_pressure + "%";
        document.getElementById("temp_val").innerHTML = data.temperature + "°C";
        document.getElementById("batt_val").innerHTML = data.battery_percent + "%";
    });
}

// Auto refresh every 1 sec
setInterval(updateFeedback, 1000);

</script>

</body>
</html>
"""
